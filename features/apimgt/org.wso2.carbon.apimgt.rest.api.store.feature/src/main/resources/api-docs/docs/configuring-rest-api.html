<!--
  ~ Copyright (c) 2016, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="main-content">
    <h2>Configuring the REST API</h2>
    
    <p>This section explains how to configure the API Manager REST APIs: </p>
    
    <h3>Changing Default Roles</h3>

    <p>Some of the resources of the REST API is protected using OAuth 2.0 scopes. There is a configuration file (tenant-conf.json) per each tenant which has a 
        section called <b>RESTAPIScopes</b>, which contains a mapping between all the scopes that are available with API Manager REST APIs with a set of roles.
        You can find tenant-conf.json file in each tenant by logging into Carbon Management Console and browsing the registry according to the below image.
    </p>
    <img src="assets/images/tenant-conf.jpg">

    <p>When a user requires to access a resource protected by an OAuth 2.0 scope, he/she should provide an access token
        associated with that particular scope as Bearer token in Authorization header. In order to
        retrieve that, the user need to invoke Token API and request that scope (Please see <b>Getting Started</b>
        section for more information). When providing such access token,
        Token API will validate the eligibility of the user for that scope using this <b>RESTAPIScopes</b>
        configuration. Only if the user has one or more of the roles specified in the <b>RESTAPIScopes</b> configuration
        for that scope, an access token will be issued for the user with that scope.</p>

    <p>You can modify the default roles defined in <b>RESTAPIScopes</b> configuration according to your requirements.
        But make sure you do not modify any of the scope names.</p>

    <p>Sample REST API Scopes configuration:</p>
    <div class="pre"><code class="json">{
   "RESTAPIScopes":{
      "Scope":[
         {
            "Name":"apim:api_publish",
            "Roles":"admin"
         },
         {
            "Name":"apim:api_create",
            "Roles":"admin"
         },
         {
            "Name":"apim:api_view",
            "Roles":"admin"
         },
         {
            "Name":"apim:subscribe",
            "Roles":"Internal/subscriber"
         },
         {
            "Name":"apim:tier_view",
            "Roles":"admin"
         },
         {
            "Name":"apim:tier_manage",
            "Roles":"admin"
         },
         {
            "Name":"apim:subscription_view",
            "Roles":"admin"
         },
         {
            "Name":"apim:subscription_block",
            "Roles":"admin"
         }
      ]
   }
}</code></div>
<br>
    <p>
        <b>NOTE: </b>You need to restart the server in order to effect the changes done to <b>RESTAPIScopes</b> configuration.
    </p>
<p>
    When specifying multiple roles for an scope, they need to be specified as comma separated values. See below example.
</p>
    <div class="pre"><code class="json">{
    "Name": "apim:tier_view",
    "Roles": "admin,portal-admin"
}</code></div>
<br>

    <p>
        <b>NOTE: </b> In API Manager 1.10.0, <b>Internal/subscriber</b> role is <b>NOT</b> automatically created when creating a new tenant. In order to tenant users to
        retrieve <b>apim:subscribe</b> scope, you should manually create <b>Internal/subscriber</b> role and assign it to the particular user.
    </p>
</div>